<div class="checkout-container">
  <h2>Checkout</h2>
  <div *ngIf="errorMessage" class="error">{{ errorMessage }}</div>
  <div *ngIf="successMessage" class="success">{{ successMessage }}</div>
  <div
    *ngIf="!cartItems.length && !errorMessage && !successMessage"
    class="empty-cart"
  >
    Your cart is empty. <a routerLink="/products">Shop now</a>.
  </div>
  <div *ngIf="cartItems.length" class="order-summary">
    <h3>Order Summary</h3>
    <div class="cart-item" *ngFor="let item of cartItems">
      <p>
        <strong>{{ item.name }}</strong>
      </p>
      <p>Price: ${{ item.price }}</p>
      <p>Quantity: {{ item.quantity }}</p>
      <p>Subtotal: ${{ item.price * item.quantity }}</p>
    </div>
    <div class="payment-section">
      <h3>Payment Method</h3>
      <div class="payment-methods">
        <label *ngFor="let method of paymentMethods">
          <input
            type="radio"
            name="paymentMethod"
            [value]="method.value"
            [(ngModel)]="selectedPaymentMethod"
          />
          {{ method.label }}
        </label>
      </div>

      <div *ngIf="selectedPaymentMethod === 'MPESA'" class="phone-input">
        <label for="phoneNumber">Phone Number (for M-Pesa):</label>
        <input
          id="phoneNumber"
          type="tel"
          placeholder="e.g., 0712345678"
          [(ngModel)]="phoneNumber"
          required
        />
        <small>Enter your M-Pesa registered phone number</small>
      </div>
    </div>

    <div class="cart-total">
      <h3>Total: ${{ total }}</h3>
      <button mat-raised-button color="primary" (click)="openConfirmDialog()">
        Place Order
      </button>
      <button mat-button routerLink="/cart">Back to Cart</button>
    </div>
  </div>
</div>
