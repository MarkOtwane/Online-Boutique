<div class="tracking-page">
  <!-- Hero Section -->
  <section class="hero-section">
    <div class="hero-content">
      <div class="hero-icon">
        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
        </svg>
      </div>
      <h1 class="hero-title">Track Your Order</h1>
      <p class="hero-subtitle">Enter your tracking ID to see real-time updates on your package journey</p>
    </div>
  </section>

  <!-- Main Content -->
  <section class="main-content">
    <!-- Search Card -->
    <div class="search-card">
      <div class="search-form">
        <div class="search-input-group">
          <div class="search-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <circle cx="11" cy="11" r="8"/>
              <path d="m21 21-4.35-4.35"/>
            </svg>
          </div>
          <input
            type="text"
            id="trackingId"
            [(ngModel)]="trackingId"
            (keyup.enter)="searchTracking()"
            placeholder="Enter tracking ID (e.g., TRK-123456)"
            class="search-input"
            [class.error]="error"
          />
        </div>
        <button
          (click)="searchTracking()"
          [disabled]="loading"
          class="search-button"
        >
          <svg *ngIf="!loading" class="button-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
          </svg>
          <span *ngIf="loading" class="spinner"></span>
          {{ loading ? 'Searching...' : 'Track Package' }}
        </button>
      </div>

      <!-- Error Message -->
      <div *ngIf="error" class="error-message">
        <svg class="error-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
        </svg>
        <span class="error-text">{{ error }}</span>
      </div>
    </div>

    <!-- Tracking Results -->
    <div *ngIf="trackingInfo" class="tracking-results">
      <!-- Status Overview Card -->
      <div class="status-card">
        <div class="status-header">
          <div class="tracking-info">
            <div class="tracking-id">
              <svg class="id-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"/>
              </svg>
              {{ trackingInfo.trackingId }}
            </div>
            <div class="last-updated">
              <svg class="time-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
              </svg>
              Last updated: {{ formatDate(trackingInfo.lastUpdated) }}
            </div>
          </div>
          <div class="status-badge"
               [ngClass]="{
                 'status-pending': trackingInfo.currentStatus === 'Pending' || trackingInfo.currentStatus === 'ORDER_PLACED',
                 'status-processing': trackingInfo.currentStatus === 'Processing' || trackingInfo.currentStatus === 'PROCESSING',
                 'status-shipped': trackingInfo.currentStatus === 'Shipped' || trackingInfo.currentStatus === 'SHIPPED' || trackingInfo.currentStatus === 'In Transit' || trackingInfo.currentStatus === 'IN_TRANSIT',
                 'status-delivery': trackingInfo.currentStatus === 'Out for Delivery' || trackingInfo.currentStatus === 'OUT_FOR_DELIVERY',
                 'status-delivered': trackingInfo.currentStatus === 'Delivered' || trackingInfo.currentStatus === 'DELIVERED'
               }">
            <span class="status-dot"></span>
            {{ formatStatusLabel(trackingInfo.currentStatus) }}
          </div>
        </div>

        <!-- Progress Bar -->
        <div class="progress-section">
          <div class="progress-steps">
            <div *ngFor="let step of getProgressSteps(); let i = index" class="progress-step">
              <div class="progress-line" *ngIf="i < getProgressSteps().length - 1"
                   [class.completed]="step.completed"></div>
              <div class="progress-circle" [ngClass]="step">
                <svg *ngIf="step.completed" class="check-icon" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                </svg>
                <span *ngIf="!step.completed" class="step-number">{{ step.number }}</span>
              </div>
              <div class="step-label">{{ step.label }}</div>
            </div>
          </div>
        </div>

        <!-- Estimated Delivery -->
        <div *ngIf="trackingInfo.estimatedDelivery" class="delivery-info">
          <div class="delivery-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
            </svg>
          </div>
          <div class="delivery-details">
            <span class="delivery-label">Estimated Delivery</span>
            <span class="delivery-date">{{ formatDeliveryDate(trackingInfo.estimatedDelivery) }}</span>
          </div>
        </div>
      </div>

      <!-- Status History Timeline -->
      <div *ngIf="trackingInfo.statusHistory && trackingInfo.statusHistory.length > 0" class="timeline-card">
        <div class="timeline-header">
          <div class="timeline-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
          </div>
          <h2 class="timeline-title">Tracking History</h2>
        </div>

        <div class="timeline">
          <div class="timeline-line"></div>
          <div class="timeline-items">
            <div *ngFor="let checkpoint of trackingInfo.statusHistory; let i = index; trackBy: trackByTimestamp"
                 class="timeline-item" [class.latest]="i === 0">
              <div class="timeline-dot" [class.latest]="i === 0"></div>
              <div class="timeline-content">
                <div class="content-header">
                  <h3 class="content-title" [class.latest]="i === 0">{{ formatStatusLabel(checkpoint.status) }}</h3>
                  <div class="content-location">
                    <svg class="location-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
                    </svg>
                    {{ checkpoint.location }}
                  </div>
                </div>
                <div class="content-time" [class.latest]="i === 0">
                  <svg class="time-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                  </svg>
                  {{ formatTimelineDate(checkpoint.timestamp) }}
                </div>
                <p *ngIf="checkpoint.notes" class="content-notes">{{ checkpoint.notes }}</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Empty State -->
    <div *ngIf="!trackingInfo && !error && !loading" class="empty-state">
      <div class="empty-icon">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <path stroke-linecap="round" stroke-linejoin="round" d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
          <polyline points="3.27 6.96 12 12.01 20.73 6.96"/>
          <line x1="12" y1="22.08" x2="12" y2="12"/>
        </svg>
      </div>
      <h3 class="empty-title">Ready to Track Your Package?</h3>
      <p class="empty-subtitle">Enter your tracking ID above to see the latest updates on your order's journey.</p>
    </div>
  </section>
</div>